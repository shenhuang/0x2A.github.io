<!--Copyright to Shen Huang, you can reach me out at shenhuang@live.ca-->

<!DOCTYPE html>
<meta name = "viewport" content = "width = device-width, initial-scale = 1.0">
<html>
	<head>
		<title>ðŸ˜€ ðŸ¤£ vs. ðŸ˜œ ðŸ¤ª</title>	
		<style>
		@keyframes bgcolor {
			0% {
				background-color : #000f04;
			}
			100% {
				background-color : #010112;
			}
		}
		body {
			background-color: #010112;
			-webkit-animation : bgcolor 5s ease-out;
			animation : bgcolor 5s ease-out;
		}
		.dummy {
			z-index : 100;
			position : absolute;
			line-height : 0;
			text-indent : 0%;
		}
		.player {
			z-index : 100;
			visibility : hidden;
			position : absolute;
			line-height : 0;
			text-indent : 0%;
		}
		</style>
	</head>
	<body>

	</body>
	<script>

		const fieldSizeX = 2000;
		const fieldSizeY = 2000;
		
		const startSize = 16;
		const startWeight = 5000;
		const weightSize = Math.sqrt(startWeight);

		var dummy;
		var player = createPlayer(200, 200, startWeight);
		var camera = createCamera(100, 100, 1);

		function createPlayer(x, y, weight)
		{
			var player = document.createElement("DIV");
			player.textContent = "ðŸ˜€"
			player.setAttribute('class', 'player');
			document.body.appendChild(player);
			player.weight = weight;
			player.setAttribute('width', Math.sqrt(player.weight));
			player.setAttribute('height', Math.sqrt(player.weight));
			player.displaySize = Math.sqrt(player.weight);
			player.style.fontSize = Math.sqrt(player.weight) + "px";
			player.position = [];
			player.position.x = x;
			player.position.y = y;
			player.energy = 1000;
			player.speed = 0;
			return player;
		}

		function createDummy(x, y, size)
		{
			var dummy = document.createElement("DIV");
			dummy.textContent = "ðŸ˜€"
			dummy.setAttribute('class', 'dummy');
			document.body.appendChild(dummy);
			dummy.style.fontSize = size + "px";
			dummy.style.left = (x - size / 2) + "px";
			dummy.style.top = y + "px";
			return dummy;
		}

		function createCamera(x, y, scale)
		{
			camera = [];
			camera.position = [];
			camera.position.x = x;
			camera.position.y = y;
			camera.scale = scale;
			return camera;
		}

		var cursor_position = [];
		var cursor_position_first;

		window.onmouseup = function(event){
			updateCursorPosition(event);
		};

		window.onmousedown = function(event){
			updateCursorPosition(event);
		};

		window.onmousemove = function(event){
			updateCursorPosition(event);
		};

		function updateCursorPosition(mouseEvent)
		{
			if(cursor_position_first == null)
			{
				cursor_position_first = [];
				cursor_position_first.x = mouseEvent.x;
				cursor_position_first.y = mouseEvent.y;
				dummy = createDummy(mouseEvent.x, mouseEvent.y, startSize);
			}
			cursor_position.x = mouseEvent.x;
			cursor_position.y = mouseEvent.y;
		}

		const loadTimeInitial = 3000;
		var loadTime = loadTimeInitial;
		var before = Date.now();
		var ld = setInterval(startFrame, 25);
		var fr;

		function startFrame()
		{
			var current = Date.now();
			var deltaTime = current - before;
			loadTime -= deltaTime;
			if(dummy != null && loadTime > 0)
			{
				var size = weightSize - (weightSize - startSize) * loadTime / loadTimeInitial;
				dummy.style.fontSize = size + "px";
				dummy.style.left = (window.innerWidth / 2 - (window.innerWidth / 2 - cursor_position_first.x) * loadTime / loadTimeInitial - size / 2) + "px";
				dummy.style.top = (window.innerHeight / 2 - (window.innerHeight / 2 - cursor_position_first.y) * loadTime / loadTimeInitial) + "px";
			}
			else
			{
				if(dummy != null)
				{
					dummy.parentNode.removeChild(dummy);
					player.style.left = (window.innerWidth / 2 - player.displaySize / 2) + "px";
					player.style.top = window.innerHeight / 2 + "px";
					player.style.visibility = "visible";
					fr = setInterval(updateFrame, 25);
					clearInterval(ld);
				}
			}
		}

		function updateFrame()
		{
			var current = Date.now();
			var deltaTime = current - before;
			updateCamera(deltaTime);
			var size = player.displaySize * camera.scale;
			player.style.left = (window.innerWidth / 2 + player.position.x - camera.position.x - size / 2) + "px";
			player.style.top = window.innerHeight / 2 + player.position.y - camera.position.y + "px";
			player.style.fontSize = size + "px";

		}

		const cameraSpeedTranslate = 1;
		const cameraSpeeScale = 0.1;
		const cameraScaleMultiplier = 50;
		

		function updateCamera(deltaTime)
		{
			var xDiff = player.position.x - camera.position.x;
			var yDiff = player.position.y - camera.position.y;
			var angle = Math.atan2(yDiff, xDiff);
			camera.position.x += cameraSpeedTranslate * Math.cos(angle) * deltaTime;
			camera.position.y += cameraSpeedTranslate * Math.sin(angle) * deltaTime;
			if(camera.position.x < window.innerWidth / 2)
				camera.position.x = innerWidth / 2;
			if(camera.position.x > fieldSizeX - window.innerWidth / 2)
				camera.position.x = innerWidth / 2;
			if(camera.position.y < window.innerHeight / 2)
				camera.position.y = innerHeight / 2;
			if(camera.position.y > fieldSizeY - window.innerHeight / 2)
				camera.position.y = innerHeight / 2;
			var sDiff = player.weightSize / cameraScaleMultiplier - 
		}

	</script>
</html>